!function(){"use strict";var t={d:function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{default:function(){return b}});var n=function(t){return new Promise((function(e,n){var r,o,i,a=(r="adserver_scope",null!==(o=null===(i="; ".concat(document.cookie).split("; ".concat(r,"=")).pop())||void 0===i?void 0:i.split(";").shift())&&void 0!==o?o:null);a&&t.set("scope",a);var c,u=new XMLHttpRequest;u.open("GET","".concat((c=window.location.hostname,"https://".concat(c.replace("dev","www"))),"/adn/api?").concat(t.toString())),u.responseType="json",u.onload=function(){[200,204].includes(null==u?void 0:u.status)||n(new Error("status code ".concat(null==u?void 0:u.status," not valid"))),e(u.response)},u.onerror=function(){n(new Error("XMLHttpRequest network error"))},u.send()}))},r="/advertising/adn",o="cleanAndSend",i="success",a="error",c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;window.melidata&&window.melidata(o,"event",{path:e,event_data:t})},u=function(t){return{status:i,source:"script",params:{placement:(null==t?void 0:t.getAttribute("data-placement"))||"",page:(null==t?void 0:t.getAttribute("data-page"))||"",slot_id:(null==t?void 0:t.getAttribute("data-slot_id"))||""}}},l=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=u(t);e&&(r.status=a,r.reason=e,null==t||t.setAttribute("style","display:none")),n&&(r.status=i),c(r)};function s(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||f(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,o,i=[],a=!0,c=!1;try{for(n=n.call(t);!(a=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);a=!0);}catch(t){c=!0,o=t}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}(t,e)||f(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var v=function(t){try{return JSON.stringify(t)}catch(t){return JSON.stringify([])}},m=function(t){return new Promise((function(e,r){var o,i=function(t){for(var e={},n=0;n<t.attributes.length;n+=1){var r,o=null!==(r=t.attributes[n].name.replace("data-",""))&&void 0!==r?r:"";"component"!==o&&(e["".concat(o)]=t.attributes[n].value)}return new URLSearchParams(e)}(t);i.set("unique_id",(o=(new Date).getTime(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=(o+16*Math.random())%16|0;return o=Math.floor(o/16),("x"==t?e:3&e|8).toString(16)})))),n(i).then((function(n){if(null!=n&&n.items.length){var o=d(n.items,1)[0];e({item:o,banner:t})}else l(t,"Empty response, with params ".concat(i.toString())),r()})).catch((function(e){l(t,"fail fetching: ".concat(e.message,", with params ").concat(i.toString())),r()}))}))},y=function(){var t=document.querySelectorAll('[data-component="adn"]'),e={};t.length>0?Promise.allSettled(s(t).map(m)).then((function(t){t.forEach((function(t){if("fulfilled"===t.status){var n=t.value,r=n.item,o=r.content,i=o.actions.content_link.link,a=o.texts,c=o.images,u=o.colors,s=r.event_tracking,d=s.print,f=s.click,p=s.view,m=r.template,y=r.lazy_loading_print_percentage,b=n.banner;if(!e[m.url]){e[m.url]=m.url;var h=document.createElement("script");h.src=m.url,document.head.appendChild(h)}var g=document.createElement("".concat(m.tag));if(Object.keys(a).forEach((function(t){return g.setAttribute(t,a[t])})),Object.keys(c).forEach((function(t){return g.setAttribute(t,c[t])})),Object.keys(u).forEach((function(t){return g.setAttribute(t,u[t])})),g.setAttribute("destination_url",i),g.setAttribute("print_url",v(d)),g.setAttribute("click_url",v(f)),p&&g.setAttribute("view_url",v(p)),y>-1&&"IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype&&"isIntersecting"in window.IntersectionObserverEntry.prototype){var w=function(){var t=arguments.length>1?arguments[1]:void 0;return new IntersectionObserver((function(e,n){e.forEach((function(e){e.isIntersecting&&(e.target.appendChild(t),n.disconnect())}))}),{root:null,rootMargin:"".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,"%")})}(y,g);w.observe(b)}else b.appendChild(g);l(b)}}))})).catch((function(){t.forEach((function(t){return l(t,"error adding banners")}))})):l(void 0,"banners not found")},b=void function(t){var e=document.createElement("script");"noModule"in e!=!1&&Promise.allSettled?t():(e.src="https://http2.mlstatic.com/frontend-assets/adn-frontend-library/adn-polyfills.js",e.defer=!0,e.onload=t,document.head.appendChild(e))}(y),h=window;for(var g in e)h[g]=e[g];e.__esModule&&Object.defineProperty(h,"__esModule",{value:!0})}();
//# sourceMappingURL=adn-script.js.map